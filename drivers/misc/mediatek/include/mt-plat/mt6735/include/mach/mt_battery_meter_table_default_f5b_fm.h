
#define BAT_NTC_10 1
#define BAT_NTC_47 0

#if (BAT_NTC_10 == 1)
#define RBAT_PULL_UP_R             16900
#endif

#if (BAT_NTC_47 == 1)
#define RBAT_PULL_UP_R             61900
#endif

#define RBAT_PULL_UP_VOLT          1800

typedef struct _BATTERY_PROFILE_STRUCT {
	signed int percentage;
	signed int voltage;
} BATTERY_PROFILE_STRUCT, *BATTERY_PROFILE_STRUCT_P;

typedef struct _R_PROFILE_STRUCT {
	signed int resistance;
	signed int voltage;
} R_PROFILE_STRUCT, *R_PROFILE_STRUCT_P;

typedef enum {
	T1_0C,
	T2_25C,
	T3_50C
} PROFILE_TEMPERATURE;

#if (BAT_NTC_10 == 1)
BATT_TEMPERATURE Batt_Temperature_Table[] = {
	{-20, 68237},
	{-15, 53650},
	{-10, 42506},
	{ -5, 33892},
	{  0, 27219},
	{  5, 22021},
	{ 10, 17926},
	{ 15, 14674},
	{ 20, 12081},
	{ 25, 10000},
	{ 30, 8315},
	{ 35, 6948},
	{ 40, 5834},
	{ 45, 4917},
	{ 50, 4161},
	{ 55, 3535},
	{ 60, 3014}
};
#endif

#if (BAT_NTC_47 == 1)
	BATT_TEMPERATURE Batt_Temperature_Table[] = {
	{-20, 483954},
	{-15, 360850},
	{-10, 271697},
	{ -5, 206463},
	{  0, 158214},
	{  5, 122259},
	{ 10, 95227},
	{ 15, 74730},
	{ 20, 59065},
	{ 25, 47000},
	{ 30, 37643},
	{ 35, 30334},
	{ 40, 24591},
	{ 45, 20048},
	{ 50, 16433},
	{ 55, 13539},
	{ 60, 11210}
	};
#endif

// T0 -10C
BATTERY_PROFILE_STRUCT battery_profile_t0[] =
{
	{0 , 4348},
	{1 , 4308},
	{3 , 4285},
	{4 , 4264},
	{6 , 4247},
	{7 , 4229},
	{9 , 4213},
	{10 ,4197},
	{12 ,4182},
	{13 ,4168},
	{15 ,4152},
	{16 ,4136},
	{18 ,4121},
	{19 ,4107},
	{20 ,4094},
	{22 ,4084},
	{23 ,4072},
	{25 ,4051},
	{26 ,4023},
	{28 ,3998},
	{29 ,3978},
	{31 ,3963},
	{32 ,3951},
	{34 ,3940},
	{35 ,3934},
	{37 ,3925},
	{38 ,3916},
	{39 ,3905},
	{41 ,3895},
	{42 ,3884},
	{44 ,3875},
	{45 ,3865},
	{47 ,3859},
	{48 ,3849},
	{50 ,3842},
	{51 ,3835},
	{53 ,3829},
	{54 ,3823},
	{56 ,3817},
	{57 ,3810},
	{58 ,3805},
	{60 ,3800},
	{61 ,3795},
	{63 ,3792},
	{64 ,3788},
	{66 ,3787},
	{67 ,3784},
	{69 ,3781},
	{70 ,3780},
	{72 ,3777},
	{73 ,3774},
	{75 ,3770},
	{76 ,3766},
	{77 ,3761},
	{79 ,3756},
	{80 ,3751},
	{82 ,3743},
	{83 ,3738},
	{85 ,3729},
	{86 ,3722},
	{88 ,3716},
	{89 ,3709},
	{91 ,3704},
	{92 ,3697},
	{94 ,3683},
	{95 ,3658},
	{96 ,3606},
	{98 ,3521},
	{100,3400},
	{100,3400},
	{100,3400},
	{100,3400}, 
	{100,3400}, 
	{100,3400}, 
	{100,3400}, 
	{100,3400}, 
	{100,3400}, 
	{100,3400}, 
	{100,3400}, 
	{100,3400}, 
	{100,3400}
};            
              
// T1 0C      
BATTERY_PROFILE_STRUCT battery_profile_t1[] =
{             
	{0 , 4347},
	{1  , 4310},
	{3  , 4287},
	{4  , 4269},
	{6  , 4252},
	{7  , 4234},
	{9  , 4218},
	{10  , 4202},
	{12  , 4188},
	{13  , 4173},
	{15  , 4158},
	{16  , 4142},
	{18  , 4127},
	{19  , 4113},
	{21  , 4098},
	{22  , 4089},
	{24  , 4082},
	{25  , 4067},
	{26  , 4043},
	{28  , 4016},
	{29  , 3996},
	{31  , 3981},
	{32  , 3970},
	{34  , 3961},
	{35  , 3954},
	{37  , 3944},
	{38  , 3931},
	{40  , 3921},
	{41  , 3909},
	{43  , 3897},
	{44  , 3885},
	{46  , 3876},
	{47  , 3866},
	{49  , 3854},
	{50  , 3846},
	{51  , 3840},
	{53  , 3834},
	{54  , 3827},
	{56  , 3821},
	{57  , 3816},
	{59  , 3810},
	{60  , 3807},
	{62  , 3801},
	{63  , 3798},
	{65  , 3793},
	{66  , 3791},
	{68  , 3787},
	{69  , 3784},
	{71  , 3781},
	{72  , 3780},
	{74  , 3777},
	{75  , 3774},
	{76  , 3770},
	{78  , 3767},
	{79  , 3762},
	{81  , 3756},
	{82  , 3750},
	{84  , 3743},
	{85  , 3734},
	{87  , 3724},
	{88  , 3714},
	{90  , 3707},
	{91  , 3703},
	{93  , 3700},
	{94  , 3696},
	{96  , 3685},
	{97  , 3633},
	{98  , 3547},
	{100  , 3400},
	{100 , 3400},
	{100 , 3400},
	{100 , 3400},
	{100 , 3400},
	{100 , 3400},
	{100 , 3400},
	{100 , 3400},
	{100 , 3400},
	{100 , 3400},
	{100 , 3400},
	{100 , 3400},
	{100 , 3400}
};     
      
// T2 25C
BATTERY_PROFILE_STRUCT battery_profile_t2[] =
{     
	{0  , 4344},
	{1  , 4310},
	{3  , 4289},
	{4  , 4271},
	{6  , 4251},
	{7  , 4234},
	{9  , 4218},
	{10  , 4199},
	{12  , 4183},
	{13  , 4168},
	{15  , 4154},
	{16  , 4138},
	{18  , 4121},
	{19  , 4107},
	{21  , 4092},
	{22  , 4078},
	{24  , 4068},
	{25  , 4058},
	{27  , 4037},
	{28  , 4017},
	{30  , 4004},
	{31  , 3995},
	{33  , 3985},
	{34  , 3975},
	{36  , 3965},
	{37  , 3953},
	{39  , 3942},
	{40  , 3930},
	{42  , 3916},
	{43  , 3903},
	{45  , 3887},
	{46  , 3875},
	{48  , 3863},
	{49  , 3857},
	{50  , 3845},
	{52  , 3838},
	{53  , 3833},
	{55  , 3828},
	{56  , 3822},
	{58  , 3815},
	{59  , 3811},
	{61  , 3806},
	{62  , 3801},
	{64  , 3797},
	{65  , 3794},
	{67  , 3790},
	{68  , 3786},
	{70  , 3785},
	{71  , 3779},
	{73  , 3774},
	{74  , 3769},
	{76  , 3764},
	{77  , 3758},
	{79  , 3751},
	{80  , 3746},
	{82  , 3742},
	{83  , 3735},
	{85  , 3723},
	{86  , 3715},
	{88  , 3706},
	{89  , 3695},
	{91  , 3693},
	{92  , 3692},
	{94  , 3690},
	{95  , 3684},
	{97  , 3653},
	{98  , 3586},
	{99  , 3473},
	{100 , 3400},
	{100 , 3400},
	{100 , 3400},
	{100 , 3400},
	{100 , 3400},
	{100 , 3400},
	{100 , 3400},
	{100 , 3400},
	{100 , 3400},
	{100 , 3400},
	{100 , 3400},
	{100 , 3400},
	{100 , 3400}
};     
  
/* T3 50C */
BATTERY_PROFILE_STRUCT battery_profile_t3[] = {
	{0  ,4343 },
	{1  ,4306 },
	{3  ,4286 },
	{4  ,4268 },
	{6  ,4251 },
	{7  ,4234 },
	{9  ,4218 },
	{10  ,4201 },
	{12  ,4184 },
	{13  ,4169 },
	{15  ,4154 },
	{16  ,4136 },
	{18  ,4123 },
	{19  ,4107 },
	{21  ,4093 },
	{22  ,4079 },
	{24  ,4064 },
	{25  ,4053 },
	{27  ,4040 },
	{28  ,4025 },
	{30  ,4012 },
	{31  ,4001 },
	{33  ,3988 },
	{34  ,3978 },
	{36  ,3966 },
	{37  ,3956 },
	{38  ,3947 },
	{40  ,3934 },
	{41  ,3921 },
	{43  ,3908 },
	{44  ,3893 },
	{46  ,3878 },
	{47  ,3866 },
	{49  ,3857 },
	{50  ,3849 },
	{52  ,3840 },
	{53  ,3833 },
	{55  ,3828 },
	{56  ,3821 },
	{58  ,3815 },
	{59  ,3809 },
	{61  ,3804 },
	{62  ,3799 },
	{64  ,3795 },
	{65  ,3790 },
	{67  ,3788 },
	{68  ,3783 },
	{70  ,3780 },
	{71  ,3773 },
	{73  ,3764 },
	{74  ,3756 },
	{75  ,3750 },
	{77  ,3743 },
	{78  ,3737 },
	{80  ,3730 },
	{81  ,3724 },
	{83  ,3718 },
	{84  ,3710 },
	{86  ,3703 },
	{87  ,3693 },
	{89  ,3681 },
	{90  ,3679 },
	{92  ,3677 },
	{93  ,3674 },
	{95  ,3670 },
	{96  ,3645 },
	{98  ,3584 },
	{99  ,3489 },
	{100 ,3400 },
	{100 ,3400 },
	{100 ,3400 },
	{100 ,3400 },
	{100 ,3400 },
	{100 ,3400 },
	{100 ,3400 },
	{100 ,3400 },
	{100 ,3400 },
	{100 ,3400 },
	{100 ,3400 },
	{100 ,3400 },
	{100 ,3400 }
};

/* battery profile for actual temperature. The size should be the same as T1, T2 and T3 */
BATTERY_PROFILE_STRUCT battery_profile_temperature[] = {
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 },
		{0  , 0 }
};

/* T0 -10C */
R_PROFILE_STRUCT r_profile_t0[] = {
	{658, 4348 },
	{658 , 4308 },
	{660 , 4285 },
	{653 , 4264 },
	{655 , 4247 },
	{653 , 4229 },
	{655 , 4213 },
	{655 , 4197 },
	{653 , 4182 },
	{655 , 4168 },
	{655 , 4152 },
	{653 , 4136 },
	{648 , 4121 },
	{650 , 4107 },
	{650 , 4094 },
	{662 , 4084 },
	{668 , 4072 },
	{658 , 4051 },
	{642 , 4023 },
	{630 , 3998 },
	{625 , 3978 },
	{620 , 3963 },
	{620 , 3951 },
	{618 , 3940 },
	{628 , 3934 },
	{628 , 3925 },
	{628 , 3916 },
	{620 , 3905 },
	{620 , 3895 },
	{618 , 3884 },
	{618 , 3875 },
	{618 , 3865 },
	{628 , 3859 },
	{625 , 3849 },
	{628 , 3842 },
	{630 , 3835 },
	{640 , 3829 },
	{640 , 3823 },
	{650 , 3817 },
	{648 , 3810 },
	{658 , 3805 },
	{660 , 3800 },
	{665 , 3795 },
	{675 , 3792 },
	{678 , 3788 },
	{690 , 3787 },
	{693 , 3784 },
	{700 , 3781 },
	{710 , 3780 },
	{718 , 3777 },
	{733 , 3774 },
	{740 , 3770 },
	{755 , 3766 },
	{773 , 3761 },
	{788 , 3756 },
	{808 , 3751 },
	{823 , 3743 },
	{853 , 3738 },
	{883 , 3729 },
	{918 , 3722 },
	{953 , 3716 },
	{1008 , 3709 },
	{1078 , 3704 },
	{1160 , 3697 },
	{1260 , 3683 },
	{1388 , 3658 },
	{1513 , 3606 },
	{1648 , 3521 },
	{1648 , 3521 },
	{1648, 3521 },
	{1648, 3521 },
	{1648, 3521 },
	{1648, 3521 },
	{1648, 3521 },
	{1648, 3521 },
	{1648, 3521 },
	{1648, 3521 },
	{1648, 3521 },
	{1648, 3521 },
	{1648, 3521 },
	{1648, 3400 }
};

/* T1 0C */
R_PROFILE_STRUCT r_profile_t1[] = {
	{318, 4347},
	{318, 4310},
	{315, 4287},
	{315, 4269},
	{315, 4252},
	{315, 4234},
	{315, 4218},
	{315, 4202},
	{323, 4188},
	{325, 4173},
	{325, 4158},
	{325, 4142},
	{328, 4127},
	{330, 4113},
	{330, 4098},
	{335, 4089},
	{353, 4082},
	{353, 4067},
	{343, 4043},
	{340, 4016},
	{338, 3996},
	{338, 3981},
	{335, 3970},
	{338, 3961},
	{338, 3954},
	{338, 3944},
	{325, 3931},
	{328, 3921},
	{320, 3909},
	{318, 3897},
	{308, 3885},
	{313, 3876},
	{308, 3866},
	{300, 3854},
	{300, 3846},
	{303, 3840},
	{303, 3834},
	{305, 3827},
	{305, 3821},
	{305, 3816},
	{305, 3810},
	{313, 3807},
	{313, 3801},
	{318, 3798},
	{315, 3793},
	{320, 3791},
	{323, 3787},
	{325, 3784},
	{323, 3781},
	{328, 3780},
	{323, 3777},
	{330, 3774},
	{330, 3770},
	{335, 3767},
	{335, 3762},
	{335, 3756},
	{343, 3750},
	{348, 3743},
	{350, 3734},
	{350, 3724},
	{358, 3714},
	{370, 3707},
	{380, 3703},
	{398, 3700},
	{428, 3696},
	{473, 3685},
	{493, 3633},
	{545, 3547},
	{650, 3403},
	{650, 3403},
	{650, 3403},
	{650, 3403},
	{650, 3403},
	{650, 3403},
	{650, 3403},
	{650, 3403},
	{650, 3403},
	{650, 3403},
	{650, 3403},
	{650, 3403},
	{650, 3400}
};

/* T2 25C */
R_PROFILE_STRUCT r_profile_t2[] = {
	{135 , 4344},
	{135 , 4310},
	{135 , 4289},
	{138 , 4271},
	{133 , 4251},
	{133 , 4234},
	{133 , 4218},
	{125 , 4199},
	{118 , 4183},
	{123 , 4168},
	{128 , 4154},
	{128 , 4138},
	{125 , 4121},
	{130 , 4107},
	{133 , 4092},
	{133 , 4078},
	{140 , 4068},
	{138 , 4058},
	{135 , 4037},
	{140 , 4017},
	{150 , 4004},
	{155 , 3995},
	{155 , 3985},
	{148 , 3975},
	{153 , 3965},
	{160 , 3953},
	{160 , 3942},
	{163 , 3930},
	{153 , 3916},
	{153 , 3903},
	{138 , 3887},
	{135 , 3875},
	{128 , 3863},
	{133 , 3857},
	{120 , 3845},
	{123 , 3838},
	{125 , 3833},
	{125 , 3828},
	{130 , 3822},
	{123 , 3815},
	{130 , 3811},
	{123 , 3806},
	{125 , 3801},
	{143 , 3797},
	{143 , 3794},
	{148 , 3790},
	{143 , 3786},
	{153 , 3785},
	{148  , 3779},
	{138 , 3774},
	{135 , 3769},
	{135 , 3764},
	{130 , 3758},
	{128 , 3751},
	{130 , 3746},
	{133 , 3742},
	{133 , 3735},
	{125 , 3723},
	{120 , 3715},
	{123 , 3706},
	{118 , 3695},
	{123 , 3693},
	{128 , 3692},
	{133 , 3690},
	{143 , 3684},
	{140 , 3653},
	{155 , 3586},
	{158 , 3473},
	{218 , 3450},
	{218 , 3450},
	{218 , 3450},
	{218 , 3450},
	{218 , 3450},
	{218 , 3450},
	{218 , 3450},
	{218 , 3450},
	{218 , 3450},
	{218 , 3450},
	{218 , 3450},
	{218 , 3450},
	{218 , 3400}
};   
     
/* T3 50C */
R_PROFILE_STRUCT r_profile_t3[] = {
	{103 ,4343},
	{103 ,4306},
	{103 ,4286},
	{103 ,4268},
	{105 ,4251},
	{103 ,4234},
	{110 ,4218},
	{103 ,4201},
	{103 ,4184},
	{105 ,4169},
	{108 ,4154},
	{100 ,4136},
	{103 ,4123},
	{100 ,4107},
	{110 ,4093},
	{105 ,4079},
	{103 ,4064},
	{115 ,4053},
	{108 ,4040},
	{110 ,4025},
	{110 ,4012},
	{113 ,4001},
	{113 ,3988},
	{115 ,3978},
	{110 ,3966},
	{120 ,3956},
	{125 ,3947},
	{125 ,3934},
	{128 ,3921},
	{123 ,3908},
	{123 ,3893},
	{108 ,3878},
	{108 ,3866},
	{108 ,3857},
	{105 ,3849},
	{100 ,3840},
	{105 ,3833},
	{110 ,3828},
	{103 ,3821},
	{105 ,3815},
	{103 ,3809},
	{105 ,3804},
	{108 ,3799},
	{105 ,3795},
	{105 ,3790},
	{115 ,3788},
	{110 ,3783},
	{115 ,3780},
	{113 ,3773},
	{105 ,3764},
	{110 ,3756},
	{105 ,3750},
	{110 ,3743},
	{105 ,3737},
	{105 ,3730},
	{108 ,3724},
	{105 ,3718},
	{100 ,3710},
	{110 ,3703},
	{100 ,3693},
	{103 ,3681},
	{105 ,3679},
	{108 ,3677},
	{108 ,3674},
	{113 ,3670},
	{110 ,3645},
	{118 ,3584},
	{118 ,3489},
	{145 ,3450},
	{145 ,3450},
	{145 ,3450},
	{145 ,3450},
	{145 ,3450},
	{145 ,3450},
	{145 ,3450},
	{145 ,3450},
	{145 ,3450},
	{145 ,3450},
	{145,3450},
	{145 ,3450},
	{145 ,3400}
};
  
/* r-table profile for actual temperature. The size should be the same as T1, T2 and T3 */
R_PROFILE_STRUCT r_profile_temperature[] = {
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0},
	{0, 0}
};       
         
/* ============================================================
// function prototype
// ============================================================*/
int fgauge_get_saddles(void);
BATTERY_PROFILE_STRUCT_P fgauge_get_profile(unsigned int temperature);
         
int fgauge_get_saddles_r_table(void);
R_PROFILE_STRUCT_P fgauge_get_profile_r_table(unsigned int temperature);
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
         
